# SelfClap 仕様書

## 概要

SelfClap は、**他人の評価軸から自分の評価軸へ**シフトするための日記×タスク管理CLIツールです。

凄腕の先輩に指摘され続け、結果が出ない時でも、**見えない成長**を客観的なデータで可視化します。Claude Code と統合して使用することで、データ不足時にはAIが追加入力を促し、より深い分析と自己理解を支援します。

## 背景と目的

### 解決したい課題（根本原因）

**背景ストーリー**:
- 凄腕の先輩に「論理的思考力が弱い」「技術力が低い」と指摘され続ける
- なかなか結果が出ない状態が続く
- 全く成長している感覚がない
- もう何をすればいいかわからない
- **評価軸が完全に他人（先輩）になっている**

**解決すべき課題**:
- 他人の評価でしか自分を測れない
- 見えない成長（他人は認めない成長）に気づけない
- 「結果が出ない」=「成長していない」と思い込む
- 自分で自分を見つめ直す方法がわからない
- 自分の軸を持てない

### ターゲットユーザー
- 新卒エンジニア（1〜3年目）
- Claude Code Max プランを利用している開発者
- 自己肯定感を高めたい人
- 成長を可視化したい人

### 達成したいこと（優先順位順）
1. **自分の軸を持つ** - 最重要
   - 他人の評価軸から自分の評価軸へシフト
   - 客観的な事実で自分の成長を認識
   - 「結果が出ない」≠「成長していない」を証明
2. **見えない成長の可視化**
   - 他人が認めない小さな成長を記録
   - 過去の自分との比較で成長を実感
   - 数値・データで客観的に示す
3. **精神の安定**
   - メンタルヘルスを守る
   - 自分で自分を見つめ直せるようになる
   - これ以上落ち込まないための土台作り

## コアコンセプト

### 1. Claude Code 統合前提
- Claude Code CLI 上で会話しながら使用
- API キー不要 - Claude Code Max プラン利用者がそのまま使える
- AI 機能（褒め、励まし、分析）は Claude Code が担当
- SelfClap はデータ管理と可視化に特化

### 2. 完全ローカル
- すべてのデータは `~/.selfclap/` に保存
- サーバー不要、デプロイコストゼロ
- プライバシー保護 - データは端末外に出ない
- オフラインで動作

### 3. シンプルで使いやすい
- 直感的なコマンド名
- 最小限の依存関係
- 高速な起動時間
- 日本語での親しみやすいメッセージ

## 主要機能

### 1. 日記機能

#### 1.1 日記の記録
- **何を**: その日の出来事、成果、学びを記録
- **なぜ**: 振り返りによる成長の実感、記憶の定着
- **ユーザーストーリー**:
  - ユーザーが Claude Code に「今日バグ修正できた!」と話す
  - Claude Code が内容を褒めた後、`clap diary write "バグ修正できた"` を実行
  - 日記がデータベースに保存される

#### 1.2 日記の閲覧
- **何を**: 過去の日記を読み返す
- **なぜ**: 成長の軌跡を確認、モチベーション向上
- **機能**:
  - 今日の日記を表示
  - 特定の日付の日記を表示
  - 月別の日記一覧
  - 全期間の日記一覧

#### 1.3 日記データの構造（拡張版）

**基本情報**:
- 日付（YYYY-MM-DD）
- 内容（テキスト）- 今日あったこと

**成長記録（重要）**:
- `learned_today`: 今日学んだこと（技術的なことでも、小さな気づきでも）
- `compared_to_past`: 過去の自分と比べてできるようになったこと
- `invisible_growth`: 他人は気づかないが、自分は成長したと思うこと

**評価軸の分離（核心機能）**:
- `external_feedback`: 他人（先輩など）からの評価・指摘
- `self_assessment`: 自己評価・今日の自分をどう思うか

**感情・状態**:
- `mood`: 気分（happy, neutral, tired, stressed, frustrated, anxious）
- `energy_level`: エネルギーレベル（1-5）

**困難度の記録**:
- `challenges_faced`: 今日直面した課題
- `how_overcome`: どう乗り越えたか、または乗り越えられなかったか

**メタデータ**:
- 作成日時（タイムスタンプ）
- 更新日時

#### 1.4 AIによるデータ入力促進

**重要な設計思想**: Claude Code は記録時にデータ不足を検知し、追加入力を促す

**入力促進のタイミング**:
1. **日記記録時**
   ```
   ユーザー: 「今日バグ修正できた」

   Claude Code: 「素晴らしい!記録しますね。

   より深い分析のために、いくつか質問させてください:

   【今回の分析に必要】
   - このバグ修正、以前の自分ならどのくらい時間がかかりましたか?
   - 今回はどのくらいでできましたか?

   【将来の分析に役立つ情報】
   - このバグ修正で新しく学んだことはありますか?
   - 先輩からの評価はありましたか?
   - 自分としてはどう評価していますか?」
   ```

2. **メンターモード実行時にデータ不足を検知**
   ```
   Claude Code: 「過去の成長を分析しようとしましたが、
   『学んだこと』の記録が少ないようです。

   過去の日記を振り返って、以下を追加していただけますか:
   - 2026-02-10のタスク完了時に学んだこと
   - 2026-02-08で乗り越えた課題の詳細

   これらがあると、より正確に成長を可視化できます」
   ```

3. **振り返りモード実行時**
   ```
   Claude Code: 「1週間の振り返りをします。

   今週、『過去の自分と比べてできるようになったこと』の
   記録がまだ2件しかありません。

   他の日も振り返って追記しますか?
   これがあると、成長の実感がより強くなります」
   ```

**データ入力促進の原則**:
- 押し付けない（「任意です」を明示）
- 将来どう役立つか説明する
- 具体的な質問で答えやすくする
- 一度に多く聞きすぎない（3問まで）

### 2. タスク管理機能

#### 2.1 タスクの追加
- **何を**: やるべきことをリストに追加
- **なぜ**: やることを明確にし、達成感を得る
- **ユーザーストーリー**:
  - ユーザーが「API実装しないと」と話す
  - Claude Code が `clap task add "API実装"` を実行
  - タスクが追加される

#### 2.2 タスクの管理
- **機能**:
  - タスク一覧表示（未完了のみ、すべて）
  - タスクの完了マーク
  - タスクの削除
  - 優先度設定（high, medium, low）
  - タスクの説明追加

#### 2.3 タスクの完了
- **何を**: タスクを完了としてマーク
- **なぜ**: 達成感を得る、進捗を可視化
- **ユーザーストーリー**:
  - ユーザーが「タスク1番終わった!」と話す
  - Claude Code が `clap task done 1` を実行
  - タスクが完了状態になり、完了日時が記録される

#### 2.4 タスクデータの構造（拡張版）

**基本情報**:
- ID（自動採番）
- タイトル（必須）
- 説明（オプション）
- ステータス（todo, in_progress, done）
- 優先度（low, medium, high）

**成長記録（重要）**:
- `learnings`: このタスクで学んだこと
- `difficulty_before`: 開始時の難易度(1-5) - 「難しそう」と感じた度合い
- `difficulty_after`: 完了時の難易度(1-5) - 「実際はこのくらいだった」
- `time_estimated`: 予想した所要時間
- `time_actual`: 実際の所要時間

**比較データ（過去の自分との比較用）**:
- `similar_task_before`: 過去に似たタスクをやった時の記録（手動入力またはAI提案）
- `improvement_notes`: 前回と比べてどう改善したか

**外部評価**:
- `external_review`: レビュー結果・先輩からのフィードバック

**メタデータ**:
- 作成日
- 完了日（完了時のみ）
- 作成日時・更新日時

#### 2.5 タスク完了時のAI入力促進

```
ユーザー: 「タスク1番終わった!」

Claude Code: 「お疲れ様です!完了を記録しますね。

成長を可視化するために、いくつか質問させてください:

【今すぐ答えてほしい】
- このタスク、始める前はどのくらい難しそうでしたか?(1-5)
- 実際やってみてどうでしたか?(1-5)

【任意: 将来の分析に役立ちます】
- このタスクで新しく学んだことはありますか?
- 似たタスクを前にもやったことがありますか?
  その時と比べて何か変わりましたか?」

→ clap task done 1 --difficulty-before 4 --difficulty-after 2 --learning "エラーハンドリングの書き方がわかった"
```

### 3. 振り返りモード（自分軸の確立）

**コアコンセプト**: 他人の評価から自分の評価へ

#### 3.1 振り返りモードの目的
- **何を**: 客観的なデータで「見えない成長」を可視化
- **なぜ**: 他人の評価軸から自分の評価軸へシフト
- **アプローチ**:
  - **他人軸 vs 自分軸の対比**を明確に示す
  - 「結果が出ない」≠「成長していない」を証明
  - 過去の自分との比較で成長を実感
  - 客観的な数値・事実で示す（感情論ではない）

#### 3.2 振り返りモード起動
- **コマンド**: `clap reflect`
- **ユーザーストーリー**:
  - ユーザーが「先輩にまた怒られた...もう無理かも」と話す
  - Claude Code が `clap reflect` を実行
  - SelfClapが「他人軸 vs 自分軸」のデータを出力
  - Claude Code がそのデータを解釈し、客観的な事実を提示

#### 3.3 振り返りモードで提供する情報（核心機能）

SelfClap は以下のデータを構造化して出力:

**1. 他人の評価軸 vs 自分の成長軸（最重要）**
```
【他人から見たあなた】
- 先輩の評価: "論理的思考力が弱い" "技術力が低い"
- 認められた成果: まだ少ない
- 外部からの評価: 低いまま

【客観的なデータ: あなたの成長】
- 1ヶ月前: APIの概念が理解できなかった
  今: APIを使った実装を自分で調査できた

- 2週間前: エラーが出たら固まっていた
  今: エラーメッセージから原因を特定しようとする

- タスク完了速度: 先月平均8時間 → 今月平均5.5時間 (31%改善)
- 難易度認識の変化: 開始時4.2 → 完了時2.8 (理解度向上の証拠)
```

**2. 見える成長 vs 見えない成長**
```
【見える成長】(他人が認める)
- まだ少ない

【見えない成長】(データが証明する)
- ドキュメントを読む習慣がついた (週0回→週5回)
- 同じミスの再発率: 70% → 20%
- 質問前の自己調査時間: 5分 → 30分
- コードレビュー指摘への対応速度: 2日 → 半日
```

**3. 過去の自分との具体的比較**
- `compared_to_past` フィールドから抽出
- 時系列での変化をグラフ化
- 「できなかったこと」が「できること」に変わった記録

**4. 学びの蓄積**
- 累積学習項目数
- 繰り返し学習が必要だった項目
- 定着した知識・スキル

**5. 思考パターンの変化**
- ネガティブな思考の頻度推移
- 「わからない」→「調べる」への行動変化
- 自己評価の変化（自己評価フィールドから）

**6. データ不足の指摘**
```
【分析に必要なデータが不足しています】

より正確に成長を可視化するために、以下を追記してください:

- 2026-02-10: タスク完了時の学び
- 2026-02-08: 「過去の自分と比べてできたこと」
- 2026-02-05: 先輩からの指摘内容と自己評価

これらがあると、他人軸 vs 自分軸の対比がより明確になります。
```

#### 3.4 メンターモードの出力形式
```yaml
mentor_data:
  current_state:
    recent_mood: [tired, stressed, neutral]
    recent_completion_rate: 0.6
    streak_status: "5日連続"

  similar_past_situations:
    - date: "2026-01-15"
      mood: stressed
      content: "バグが直らなくて辛い"
      recovery:
        - date: "2026-01-17"
          content: "バグ修正できた!"

  success_patterns:
    - "過去30日で20個のタスク完了"
    - "最長14日連続記録"
    - "API実装を3回成功"

  thought_patterns:
    recurring_worries:
      - "実装が遅い"
      - "レビューで指摘される"
    coping_strategies:
      - "小さく分割して進める"
      - "先輩に質問する"

  encouragement_points:
    - "実は今月のタスク完了率は先月より高い"
    - "5日連続で記録継続中"
```

Claude Code がこのデータを読み取り、適切に傾聴・励ます。

#### 3.5 振り返りモードの原則
- **客観性重視**: 感情論ではなく、データと事実で示す
- **他人軸 vs 自分軸**: この対比を常に意識
- **過去の自分が基準**: 他人ではなく、過去の自分と比較
- **成長の証明**: 「結果が出ない」≠「成長していない」を証明

### 4. 傾聴モード（追加機能）

**コンセプト**: つらい時にまず受け止める

#### 4.1 傾聴モードの目的
- **何を**: 感情に寄り添い、まず受け止める
- **なぜ**: 分析や客観視よりも、温かい言葉が欲しい時がある
- **違い**:
  - `reflect` モード: データで客観的に示す
  - `listen` モード: 感情に寄り添い、共感する

#### 4.2 傾聴モード起動
- **コマンド**: `clap listen`
- **ユーザーストーリー**:
  - ユーザーが「もう疲れた...つらい...」と話す
  - Claude Code が `clap listen` を実行
  - 過去のデータを取得（`reflect`と同じデータ）
  - **トーンを変えて**傾聴・励まし

#### 4.3 傾聴モードで提供する情報
- データは `reflect` モードと同じものを使用
- **プロンプトのトーンを変える**:
  - 客観的データ → 温かい言葉に変換
  - 分析結果 → 共感と励ましに変換

#### 4.4 傾聴モードの出力形式

```yaml
listen_mode_prompt: |
  あなたは優しく傾聴するメンターです。

  以下のデータを参考に、まず受け止めて、寄り添ってください。
  解決策を押し付けず、共感と理解を示してください。

  【ユーザーの状況】
  - 最近の気分: {recent_moods}
  - 最近の外部評価: {recent_external_feedback}
  - 現在の状態: {current_state}

  【過去のデータ】
  - 似た状況からの回復: {recovery_patterns}
  - 過去の成功体験: {past_successes}
  - 乗り越えてきた課題: {overcome_challenges}

  まずユーザーの気持ちを受け止め、
  その後でデータを踏まえた励ましをお願いします。

  「つらかったですね」「よく頑張っていますね」など、
  温かい言葉から始めてください。
```

#### 4.5 傾聴モードの原則
- **共感第一**: まず気持ちを受け止める
- **温かいトーン**: データより感情に配慮
- **解決を急がない**: 寄り添うことが目的
- **過去の回復パターン**: 「あの時も乗り越えた」を優しく伝える
- **無理をさせない**: 「今日は休んでもいい」という選択肢

#### 4.6 実装の軽さ
- データ取得: `reflect` モードと同じロジックを流用
- 差分: プロンプトのトーンを変えるだけ
- 実装工数: 約20分

### 5. 統計・可視化機能

#### 5.1 統計ダッシュボード
- **何を**: 継続記録、タスク完了数などの統計を表示
- **なぜ**: 努力の積み重ねを数値で実感
- **表示内容**:
  - 現在の連続記録日数
  - 最長連続記録日数
  - 今月の日記エントリ数
  - 今月の完了タスク数
  - 1日平均タスク完了数
  - 最も多い気分

#### 5.2 継続カレンダー
- **何を**: カレンダー形式で記録状況を表示
- **なぜ**: 視覚的に継続を確認、習慣化を促進
- **表示形式**:
  - 月別カレンダー
  - 日記記録あり/なし
  - タスク完了あり/なし
  - 色分け（例: 🟢日記+タスク、🟡日記のみ、⚪記録なし）

#### 5.3 グラフ表示
- **何を**: タスク完了数の推移グラフ
- **なぜ**: トレンドを把握、モチベーション向上
- **グラフ種類**:
  - 過去30日のタスク完了数推移（ASCIIグラフ）
  - 気分の分布（オプション）

### 6. データ管理機能

#### 6.1 初期化
- **何を**: 初回実行時のセットアップ
- **処理内容**:
  - `~/.selfclap/` ディレクトリ作成
  - SQLite データベースファイル作成
  - テーブル初期化
  - 設定ファイル作成（オプション）

#### 6.2 データの永続化
- **ストレージ**: SQLite データベース（`~/.selfclap/selfclap.db`）
- **テーブル構成**:
  - `diary_entries`: 日記エントリ
  - `tasks`: タスク
  - `stats_cache`: 統計キャッシュ（任意）

#### 6.3 データのエクスポート（将来的）
- 月別マークダウンファイルへのエクスポート
- Git管理可能な形式での保存

## 非機能要件

### パフォーマンス
- シンプルなコマンドは100ms以内に起動
- データベースクエリは適切にインデックス化
- 1000件のエントリでもスムーズに動作

### セキュリティ・プライバシー
- すべてのデータはローカルに保存
- 外部への通信なし（Claude Code 統合を除く）
- 個人情報は収集しない

### 可用性
- オフラインで完全に動作
- データの破損に対する適切なエラーハンドリング

### 保守性
- モジュラーな設計（cli, database, visualization 分離）
- 型ヒントとdocstringによるドキュメント化
- ユニットテストでコアロジックをカバー

## 技術的制約

### 言語・ランタイム
- Python 3.10 以上

### データベース
- SQLite 3（標準ライブラリ）

### UI
- ターミナル（CLI）
- Rich ライブラリによる装飾

### 依存ライブラリ（最小限）
- typer: CLIフレームワーク
- rich: ターミナル出力
- pyyaml: 設定ファイル（オプション）
- plotille: ASCIIグラフ（オプション）

## ユーザーフロー例

### 日常的な使い方

```
1. 朝、タスクを追加
   ユーザー: 「今日はAPIの実装とドキュメント更新をやる」
   Claude: `clap task add "API実装"` + `clap task add "ドキュメント更新"`

2. 午後、タスク完了
   ユーザー: 「API実装終わった!」
   Claude: 「素晴らしい!」+ `clap task done 1`

3. 夕方、日記を記録
   ユーザー: 「今日はAPIの実装が順調に進んだ。レビューも通った」
   Claude: （褒める）+ `clap diary write "API実装完了、レビュー通過"`

4. 週末、振り返り
   ユーザー: 「今週の統計見せて」
   Claude: `clap stats` → 結果を解析して励ます
```

### 初回セットアップ

```
1. インストール
   $ git clone https://github.com/yourname/selfclap.git
   $ cd selfclap
   $ pip install -e .

2. 初回実行（自動初期化）
   Claude: `clap stats`
   → データベース自動作成、ウェルカムメッセージ表示
```

## スコープ外（将来的な拡張）

現在のバージョンでは実装しない機能:

- Web UI
- モバイルアプリ
- 複数デバイス間の同期
- チーム共有機能
- 高度な分析・レポート
- リマインダー・通知機能
- タグ付け・カテゴリ分類（タスク・日記）
- 検索機能（全文検索）
- カスタムテーマ・カラースキーム

これらは MVP（Minimum Viable Product）の後に検討します。

## 成功指標

- ユーザー（開発者自身）が毎日使い続けられる
- 1週間以上の継続記録を達成
- 振り返りによって成長を実感できる
- Claude Code との会話が自然に感じられる

## まとめ

SelfClap は、Claude Code と統合して使う、新卒エンジニア向けの自己承認ツールです。日記とタスク管理を通じて日々の努力を記録し、可視化することで、誰も認めてくれない環境でも自分で自分の成長を実感できるようにします。
